<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= currentCategory %> Reports</title>
    <link rel="stylesheet" href="/css/sdw_reports_style.css">
</head>

<body>
    <div class="container">
        <aside class="sidebar">

            <img src="/logo.png" alt="Logo" class="logo" style="scale:55%; margin: auto; ">

            <% if(staff_type === "sdw"){ %>
                <nav class="nav-menu" id="navbar">    
                    <button class="nav-btn" data-category="DSWD Annual Report">DSWD Annual Report</button>
                    <button class="nav-btn" data-category="Community Profile">Community Profile</button>
                    <button class="nav-btn" data-category="Target Vs ACC & SE">Target Vs ACC & SE</button>
                    <button class="nav-btn" data-category="Caseload Masterlist">Caseload Masterlist</button>
                    <button class="nav-btn" data-category="Education Profile">Education Profile</button>
                    <button class="nav-btn" data-category="Assistance to Families">Assistance to Families</button>
                    <button class="nav-btn" data-category="Poverty Stoplight">Poverty Stoplight</button>
                    <button class="nav-btn" data-category="CNF Candidates">CNF Candidates</button>
                    <button class="nav-btn" data-category="Retirement Candidates">Retirement Candidates</button>
                    <button class="nav-btn" data-category="VM Accomplishments">VM Accomplishments</button>
                    <button class="nav-btn" data-category="Correspondence">Correspondence</button>
                    <button class="nav-btn" data-category="Leaders Directory">Leaders Directory</button>
                </nav>
            <% } %>
        </aside>

        <main class="main-content">
            <div class="report-view-container">
                <div class="report-header">
                    <h1 class="report-title"><%= currentCategory %></h1>
                    <div class="sort-container">
                        <label for="sort-by">Sort By:</label>
                        <select id="sort-by" class="sort-select">
                            <option value="latest">Latest</option>
                            <option value="alphabetical">Alphabetically</option>
                        </select>
                    </div>
                </div>
                <% if(staff_type === "sdw"){ %>
                    <button class="upload-btn" onclick="window.location.href='/home'">Back to Upload Page</button>
                <% } else if(staff_type === "supervisor"){ %>
                    <button class="upload-btn" onclick="window.location.href='/sdw/<%= sdw_id %>'">Back</button>
                <% } %>
                <!-- Dynamic Implementation Here, Adjust parts accrodingly-->

                <%if(staff_type === "sdw") {%>
                    <br/>
                    <br/>
                    <button class="createnew-btn" onclick="createNew('<%=currentCategory%>')">+</button>
                <%}%>

                
                <div class="modal" id="appear">
                    <div class="modal-body">
                        <div class="modal-content">
                            <p class="modal-header">New File Creation in Progress...Do you want to:</p>
                            <div class="modal-buttons">
                                <button class="btn-upload-another" onclick="window.location.href='/reports/<%=currentCategory%>/download'">Download New File</button>
                                <!-- <button class="modal-buttons" onclick="">Edit New File</button> -->
                                <!-- <button class="modal-buttons" onclick="renameTemplate()">Rename New File</button> -->
                            
                                <!-- <div hidden id="renameSection">
                                    <form action="/reports/<%=currentCategory%>/rename" method="POST">
                                        <input id="newfilename" type="text">
                                        <input type="submit">
                                    </form>
                                </div> -->
                                <button class="btn-continue" onclick="createNewClose('<%=currentCategory%>')">Send New File to Storage</button>
                                <button class="btn-delete" onclick="closeNew()">Exit</button> 
                            </div>
                        </div>
                    </div>
                </div>
                
                <% if (reports.length === 0) { %>
                    <div class="empty-state">
                        <p class="upload-text">No reports found for <strong><%= currentCategory %></strong>.</p>
                        <% if (staff_type === "sdw") { %>
                            <p class="upload-subtext">Start by uploading a file on the <a href="/home">homepage</a> or create new file.</p>
                        <% } %>
                    </div>
                <% } else { %>
                    <div class="report-grid">
                        <% reports.forEach(report => { %>
                            
                            <div class="report-card"
                                 
                                data-report-id="<%= report.report_id %>"
                                data-report-name="<%= report.report_name %>"
                                data-report-size="<%= report.file_size %>"
                                data-report-date="<%= report.upload_date %>"
                                data-report-uploader="<%= staff_name || 'Unknown' %>">
                                
                                <div class="report-thumbnail">
                                    <div class="thumbnail-placeholder">
                                        <span>ðŸ“„</span>
                                    </div>
                                </div>
                                <div class="report-info">
                                        <span class="report-name"><%= report.report_name %></span>
                                </div>
                                
                                
                                
                            </div>
                        <% }); %>
                    </div>
                <% } %>
            </div>

            <button class="logout-btn" onclick="window.location.href='/logout'" style="background-color: #f05a50;">Logout</button>
        </main>
    </div>

    <!-- Simple Preview Modal -->
    <div class="modal" id="previewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalFileName">File Preview</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preview-container" id="previewContainer">
                    <div class="preview-placeholder">
                        <div>ðŸ“„</div>
                        <p>Preview not available</p>
                        <small>Click download to view the file</small>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="file-info" id="fileInfo">
                    <strong>Uploaded:</strong> <span id="uploadDate">-</span> | 
                    <strong>Size:</strong> <span id="fileSize">-</span> | 
                    <strong>By:</strong> <span id="uploader">-</span>

                    <!-- <strong>Uploaded Under SPU:</strong> <span id="supervisor">-</span> -->
                </div>
                <div class="modal-buttons">
                    <button class="btn-download" id="btnDownload">Download</button>
                    <button class="btn-delete" id="btnDelete">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/sdw_reports_functionality.js"></script>
</body>