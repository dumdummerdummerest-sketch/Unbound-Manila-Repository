<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPUs</title>
    <link rel="stylesheet" href="/css/admin_spu_style.css">
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>
</head>

<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <a><img src="/logo.png" id=logo style="scale:55%; margin: auto; "></a>
            
            <nav class="nav-menu">
                <button class="nav-btn" id="back-btn" onclick="window.location.href='/admin'"> Back to SPUs</button>
                <a href="/logout" class="nav-btn" data-category="Logout" id="logout">Logout</a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="content">
            <div class="content-main">
                <h2> Welcome to <%= spuPage %> Suite! </h2>
                <h3 style="position:absolute; left:22%"> Supervisor Assigned: </h3>
                
                <!-- Supervisor Button with Edit/Delete -->
                <% const s = (supervisor?.supervisor && supervisor.supervisor[0]) || supervisor || {}; %>
                <% const hasSupervisor = s.first_name && s.first_name !== 'Unassigned'; %>
                
                <button class="user-btn supervisor-btn">
                    <img src="/sdw_icon.png" class="sdw-icon">
                    <span><%= s.first_name || 'Unassigned' %> <%= s.last_name || '' %></span>
                    <% if (hasSupervisor) { %>
                        <div class="kebab-wrapper"><img src="/kebab.png" class="kebab" alt="Kebab Menu"></div>
                        <ul class="kebab-menu hidden">
                            <li class="edit-supervisor-btn" data-supervisor-id="<%= s.staff_info_id %>">Edit</li>
                            <li class="delete-supervisor-btn" data-supervisor-id="<%= s.staff_info_id %>" data-supervisor-name="<%= s.first_name %> <%= s.last_name %>">Delete</li>
                        </ul>
                    <% } %>
                </button>


                <h3 style="position:absolute; left:22%;"> SDWs Assigned: </h3>

                <div class="dropdown" style="position:absolute; right:30px">
                        <label>Sort by: </label>
                        <select id="sortMenu">
                            <option value="alphabetical">Alphabetical</option>
                            <option value="lastupdated">Last Updated</option>
                        </select>
                </div>

                <% if (sdws == null) { %>
                    <div class="empty-state">
                        <p class="upload-text">No SDWs Assigned For <%= user.first_name %></p>
                    </div>
                <% } else { %>
                    <div class="users" id="sdwContainer"> 
                        <% sdws.forEach(sdw => { %>
                            <button class="user-btn" onclick="navigateToSDW('<%= sdw.sdw_id %>')">
                                <img src="/sdw_icon.png" class="sdw-icon" alt="SDW Icon">
                                <span><%= sdw.first_name %> <%= sdw.middle_name %> <%= sdw.last_name %></span>
                                <div class="kebab-wrapper"><img src="/kebab.png" class="kebab" alt="Kebab Menu"></div>
                                <ul class="kebab-menu hidden">
                                    <li class="edit-btn" data-sdw-id="<%= sdw.staff_info_id %>">Edit</li>
                                    <li class="delete-btn" data-sdw-id="<%= sdw.staff_info_id %>">Delete</li>
                                </ul>
                            </button>
                        <% }); %>
                    </div>
                <% } %>
            
            </div>
        </main>
    </div>

    <script src="/js/admin_spu.js"></script>

</body>